id: list_parquet_dirs_only
namespace: enygea.dlt

inputs:
  - id: trino_catalog
    type: STRING
    defaults: "hive_json_scw"

tasks:
  - id: list_files
    type: io.kestra.plugin.aws.s3.List
    accessKeyId: "SCWB3XMCCXHTNQC5KQQH"
    secretKeyId: "764e1512-586c-4cbd-ad83-8251a0d27b7c"
    region: "fr-par"
    bucket: "sandbox-datalake-bronze"
    endpointOverride: "https://s3.fr-par.scw.cloud"
    prefix: "bronze_dlt"
    filter: FILES
    regexp: ".*.parquet"